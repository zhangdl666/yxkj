<extend name="Public:index"/>
<block name="css">
    <link rel="stylesheet" href="__PUBLIC__/dateItor/css/normalize3.0.2.min.css"/>
    <link rel="stylesheet" href="__PUBLIC__/dateItor/css/style.css?v=7"/>
    <link href="__PUBLIC__/dateItor/css/mobiscroll.css" rel="stylesheet"/>
    <link href="__PUBLIC__/dateItor/css/mobiscroll_date.css" rel="stylesheet"/>
    <link rel="stylesheet" href="__CSS__/LCalendar.css">
    <style type="text/css">
        body{
            background: #f4f4f4;
        }
        .fj_gezi_cont .i_radio {
            border-radius: 0.14rem !important;
            margin-top: 0.05rem;
        }
        .hotel_selects {
            padding: 0.3rem 0rem 0.2rem 3rem;
            background-color: white;
        }

        .jiudianxuanze{
            width: 2.93rem;
            height: 0.64rem;
            border-radius: 0.1rem;
            background-color: #f4f4f4;
            border: none;
            color: #666;
        }

        .select_yx_div{
            width: 6rem;
            height: 0.6rem;
            background-color: #f4f4f4;
            border-radius: 5px;
        }
        .yunxing{
            background-color: white;
            padding: 0.2rem 0rem;
        }
        .header .right .icon {
            margin-right: 0rem;
        }
        select {
            width: 6rem;
            padding-left: 0.2rem;
            font-size: 0.3rem;
            line-height: 0.6rem;
            text-align: left;
            /*Chrome和Firefox里面的边框是不一样的，所以复写了一下*/
            border: solid 1px #000;
            /*很关键：将默认的select选择框样式清除*/
            appearance:none;
            -moz-appearance:none;
            -webkit-appearance:none;
            /*在选择框的最右侧中间显示小箭头图片*/
            background: url("") no-repeat scroll right center transparent;
            /*为下拉小箭头留出一点位置，避免被文字覆盖*/
            padding-right: 14px;
        }


        /*清除ie的默认选择框样式清除，隐藏下拉箭头*/
        select::-ms-expand { display: none; }
        .hotel_selects {
            text-align: left;
            padding: 0.2rem 0;
            height: 1rem;
            background-color: white;
        }
        select {
            direction:inherit;
        }
        select option {
            direction: inherit;
        }
        .select_css_div{
            width: 6rem;
            height: 0.6rem;
            margin: 0 auto;
            background-color: #f4f4f4;
        }
        .editdate{
            background-color: #f4f4f4!important;
            margin: 0.2rem 0;
        }
        .screening_condition_wrap .screening {
            margin-left: 0rem!important;
        }
        .screening_condition_wrap label {
            padding-right: 0.2rem;
            font-size: 0.3rem;
            line-height: 1.1rem;
            padding-left: 0rem;
            float: none;
            margin-right: 0.1rem;
        }
        .screening_condition_wrap select, .screening_condition_wrap input {
            width: 5.50rem;
            height: 0.7rem;
            text-align: center;
        }

        /*.input_position{*/
            /*position: absolute;*/
            /*width: 100%;*/
            /*top: 50%;*/
            /*margin-top: -1.10rem;*/
        /*}*/

        .btn_icon_top .icon{background: url('__IMG__/contraction.png');
            background-repeat: no-repeat;
            background-size: contain;
            top: 0.05rem;}
        .btn_icon_bottom .icon{background: url('__IMG__/open.png');
            background-repeat: no-repeat;
            background-size: contain;
            top: 0.05rem;}
        .pc_kq_height{
            height: 0.68rem;
            overflow: hidden;
        }
        .pitch_on{
            background: url("__IMG__/pitch_on.png") no-repeat;
            background-size: 40%;
            background-position: right bottom;
            color: #4e4e4e!important;
        }
        .showdata .left {
            float: left;
            text-align: left!important;
        }
        .showdata .right {
            float: right;
            text-align: right!important;
        }
        .white_panel {
            background: #f4f4f4;
            margin-top: 0.2rem;
        }
        .jiesuan_item .left{font-size: 0.28rem;}
        .layoutlr_right{
            font-size: 0.28rem;
            color: #fff!important;
            display: table-cell !important;
            vertical-align: middle!important;
        }
        .lay_1{
            background-color: #E72B39!important;
        }
        .lay_2{background:rgba(255,156,3,1)!important;}
        .lay_3{background:rgba(255,221,30,1)!important;}
        .gezi-container .gezi-title .gezi-gay .icon {
            background: #FFDD1E;
            border-radius: 0;
            border: none;
        }
        select {
            direction: rtl;
        }
        select option {
            direction: ltr;
        }

        .checkbox-container {
            margin-right: 0rem!important;
        }

        .color1{background-color: #35ce85!important;color: #fff;}
        .color2{background-color: #ff6867!important;color: #fff;}
        .color3{background-color: #ff9a2d!important;color: #fff;}
        .color4{background-color: #FFDD1E!important;color: #fff;}

        .yunxing{
            background-color: #f4f4f4;
            padding: 0px;
        }
        .jiesuan .jiesuan_item {
            padding: 0 0.2rem;
            border-bottom: 0.22rem solid #f4f4f4;
            border-top: 0rem;
        }
        #shebeiyunxing .col-xs-6{
            width: 47%;
            margin: 1% 0% 1% 2%;
            background-color: #fff;
        }
        #shebeiyunxing .col-xs-6 .media-body {
            text-align: right;
            margin-right: 0.2rem;
            line-height: 0.4rem;

        }
        .btn_icon_top .icon {
            background: url(/Public/Images/contraction.png);
            background-repeat: no-repeat;
            background-size: contain;
            top: 0rem;
        }
        .checkbox-container span.checkbox_txt {
            font-size: 0.22rem;
        }
        .select_css_div {
            height: 0.7rem;
        }
        .select_title_left{
            width: calc(50% - 0.45rem);
            float: left;
            text-align: right;
            margin-right: 0.45rem;
        }
        .select_title_right{
            width: calc(50% - 0.45rem);
            float: right;
            text-align: left;
            margin-left: 0.45rem;
        }
        .click_gj_list{
            font-size: 0.23rem;
            color: #505050;
            line-height:0.7rem;
            padding-bottom: 0.18rem;
        }
        .gj_title_border{
            color: #1AC272;
            border-bottom: 0.04rem solid #1AC272;
        }
        .ls_gj_cont{
            display: none;
        }
        .jiesuan .jiesuan_item .jiesuan_content .left {
            width: 45%;
            overflow: hidden;
            text-overflow:ellipsis;
            white-space: nowrap;
        }
        .jiesuan .jiesuan_item .jiesuan_content .right {
            width: 55%;
            padding-right: 0rem;
            overflow: hidden;
            text-overflow:ellipsis;
            white-space: nowrap;
        }
        .loading{text-align: center;display:none;}
    </style>
</block>
<block name="title">
    <title>禁烟&防火监控预警</title>
</block>
<block name="main">
    <!-- 主体内容 开始 -->
    <div class="main swiper-container-02 xiaoshoutongji">
        <!-- 【此处嵌套 header】 -->
        <!-- header 开始 -->
        <div class="header">
            <!--<div class="left back"><i class="icon w_0000_00 w_00_08"></i><a href="{:U('Wx/Index/index')}">返回</a></div>-->
            <div class="left"><i class="icon w_0000_00 w_00_08"></i><a href="{:U('Index/index')}" style="color: white">返回</a></div>
            <!--<div class="center">运行消息</div>-->
            <!--<div class="right">-->
                <!--<i class="icon onclick_input w_0004_04 w_04_10"></i></div>-->
        </div>
        <div class="main_body jinhuaxiaoguo">
            <div class="hotel_selects" data-relation="hotel_type" >
                <div class="select_css_div" style="width: 90%; background-color: #fff;position: relative">

                    <label style="float:left;display: inline-block;font-size: 0.3rem;margin-top: 7px;color: #333">选择酒店</label>

                    <empty name="userinfo['hotel_id']">
                        <select name="h_id" id="hotelsss" style="height: 0.6rem; float: right;width: 4rem;background-color: #fff;padding-right: 20px;">
                            <volist name="hotels" id="hotel">
                                <option value="{$hotel.id}" <if condition="$hotel.id eq $h_id">selected="selected"</if>>{$hotel.name}</option>
                            </volist>
                        </select>
                        <i class="icon w_0000_00 w_00_12" style="position: absolute;top: 0.24rem;right: 0rem;"></i>
                    <else />
                        <select name="h_id" id="hotelsss" style="height: 0.6rem; float: right;width: 4rem;background-color: #fff;padding-right: 20px;" disabled="disabled">
                            <volist name="hotels" id="hotel">
                                <option value="{$hotel.id}" <if condition="$hotel.id eq $userinfo['hotel_id']">selected="selected"</if>>{$hotel.name}</option>
                            </volist>

                        </select>
                    </empty>


                </div>

            </div>
            <div class="jinhua_block">
                <dl class="gezi-container">
                    <dt class="left gezi-title" style="text-align-last: justify;padding: 0.18rem 0.4rem;">
                        <div class="checkbox-container gezi-green">
                            <span class="checkbox_txt" style="font-size: 0.3rem;color: #333">安装房间</span>
                        </div>
                        <div class="btn_kq_icon btn_icon_bottom" style="float: right;"><i class="icon"></i></div>
                    </dt>
                    <dt class="left gezi-title" style="text-align-last: justify;padding: 0.18rem 0.4rem;">
                        <div class="checkbox-container gezi-green" data-type="checkbox">
                            <i class="icon icon01 i_radio"></i>
                            <span class="checkbox_txt">运行正常</span>
                        </div>
                        <div class="checkbox-container gezi-red" data-type="checkbox">
                            <i class="icon icon01 i_radio"></i>
                            <span class="checkbox_txt">一级预警</span>
                        </div>
                        <div class="checkbox-container gezi-orange" data-type="checkbox">
                            <i class="icon icon01 i_radio"></i>
                            <span class="checkbox_txt">二级预警</span>
                        </div>
                        <div class="checkbox-container gezi-gay" data-type="checkbox">
                            <i class="icon icon01 i_radio"></i>
                            <span class="checkbox_txt">三级预警</span>
                        </div>
                        <div class="checkbox-container gezi-gay" data-type="checkbox">
                            <i class="icon icon01 i_radio" style="background: #e1e1e1;"></i>
                            <span class="checkbox_txt">离线</span>
                        </div>
                    </dt>
                    <dd class="right gezi-group pc_kq_height" id="kq_height">
                        <!------  color1 运行正常    color2 一级告警  color3 二级告警   color4 三级告警  离线则不加class------->
                        <foreach name="roomdata" item="v">
                            <switch name="v.mark" >
                                <case value="1"><button type="button" class="btn color1 room" value="{$v.equipment_sno}">{$v.room_sno}</button></case>
                                <case value="2"><button type="button" class="btn color2 room" value="{$v.equipment_sno}">{$v.room_sno}</button></case>
                                <case value="3"><button type="button" class="btn color3 room" value="{$v.equipment_sno}">{$v.room_sno}</button></case>
                                <case value="4"><button type="button" class="btn color4 room" value="{$v.equipment_sno}">{$v.room_sno}</button></case>
                                <case value="5"><button type="button" class="btn room" value="{$v.equipment_sno}">{$v.room_sno}</button></case>
                            </switch>

                        </foreach>
                        <!--<button type="button" class="btn color1 room" value="001">-->
                            <!--001-->
                        <!--</button>-->
                        <!--<button type="button" class="btn color2 room" value="002">-->
                           <!--002-->
                        <!--</button>-->
                        <!--<button type="button" class="btn color3 room" value="003">-->
                            <!--003-->
                        <!--</button>-->
                        <!--<button type="button" class="btn color4 room" value="004">-->
                            <!--004-->
                        <!--</button>-->
                        <!--<button type="button" class="btn room" value="005">-->
                            <!--005-->
                        <!--</button>-->
                    </dd>
                    <div class="btn_kq_icon btn_icon_bottom" style="text-align:center;"><i class="icon"></i></div>
                </dl>
            </div>
            <div class="sales">
                <!--设备运行情况 开始-->
                <div id="shebeiyunxing" class="yunxing">
                    <div class="col-xs-6">
                        <div class="media">
                            <div class="media-left">
                                <i class="icon jg_icon"></i>
                            </div>
                            <div class="media-body">
                                <h4 class="media-heading zise"><span class="bigfont zise">{$alarmtotal|default=0}</span>个</h4>
                                当前告警总数
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-6">
                        <div class="media">
                            <div class="media-left">
                                <i class="icon jg_icon2"></i>
                            </div>
                            <div class="media-body">
                                <h4 class="media-heading qianhong"><span class="bigfont qianhong">{$firstnum|default=0}</span>个</h4>
                                当前一级告警数
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-6">
                        <div class="media">
                            <div class="media-left">
                                <i class="icon jg_icon3"></i>
                            </div>
                            <div class="media-body">
                                <h4 class="media-heading yello"><span class="bigfont yello">{$secondnum|default=0}</span>个</h4>
                                当前二级告警数
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-6">
                        <div class="media">
                            <div class="media-left">
                                <i class="icon jg_icon4"></i>
                            </div>
                            <div class="media-body">
                                <h4 class="media-heading lanse"><span class="bigfont lanse">{$thirdnum|default=0}</span>个</h4>
                                当前三级告警数
                            </div>
                        </div>
                    </div>

                </div>
                <!--设备运行情况 结束-->
                <div class="hotel_selects" data-relation="hotel_type" style=" margin: 0.2rem 0;padding: 0;height: 0.7rem;">
                    <div class="select_css_div" style="width: 90%; background-color: #fff;position: relative">
                        <div class="select_title_left">
                            <label istext="1" class="click_gj_list gj_title_border">当前告警</label>
                        </div>
                        <div class="select_title_right">
                            <label istext="2" class="click_gj_list">历史告警</label>
                        </div>
                    </div>
                </div>
                <div class="jinhua_block" class="saleone">
                    <div class="white_panel">
                       <div class="gj_list_cont">
                           <div class="jiesuan">
                               <notempty name="alarmdatas">
                                   <volist name="alarmdatas" id="row">
                                       <a href="javascript:void(0)">
                                           <dl class="jiesuan_item">
                                               <!--------lay_1 为一级警告的背景色,lay_2 为二级警告的背景色,lay_3 为三级警告的背景色----------->
                                               <switch name="row.type" >
                                                   <case value="1"><dt class="layoutlr jiesuan_title lay_1"></case>
                                                   <case value="2"><dt class="layoutlr jiesuan_title lay_2"></case>
                                                   <case value="3"><dt class="layoutlr jiesuan_title lay_3"></case>
                                               </switch>
                                               <div class="left">告警房间：{$row.room_sno}</div>
                                               <div class="right layoutlr_right">告警等级：{$row.name}</div>
                                               </dt>
                                               <dd class="layoutlr jiesuan_content">
                                                   <div class="right">
                                                       <ul class="showdata">
                                                           <li><span class="label left">PM2.5 : {$row.start_pm25}-{$row.end_pm25}</span><span class="right">开始时间：{$row.start_time}</span></li>
                                                           <li><span class="label left">持续时间：{$row.len_time}秒</span></li>
                                                       </ul>
                                                   </div>
                                               </dd>
                                           </dl>
                                       </a>
                                   </volist>
                               <else/>
                                   <dl class="no_data_div"><img src="__IMG__/no_data.png"><span>暂时没有数据</span></dl>
                               </notempty>
                           </div>
                       </div>
                       <div class="ls_gj_cont">
                           <div class="jiesuan history">
                               <notempty name="datas">
                                   <volist name="datas" id="row2">
                                       <a href="javascript:void(0)">
                                           <dl class="jiesuan_item">
                                               <!--------lay_1 为一级警告的背景色,lay_2 为二级警告的背景色,lay_3 为三级警告的背景色----------->
                                               <switch name="row2.type" >
                                                   <case value="1"><dt class="layoutlr jiesuan_title lay_1"></case>
                                                   <case value="2"><dt class="layoutlr jiesuan_title lay_2"></case>
                                                   <case value="3"><dt class="layoutlr jiesuan_title lay_3"></case>
                                               </switch>
                                               <div class="left">告警房间：{$row2.room_sno}</div>
                                               <div class="right layoutlr_right">告警等级：{$row2.name}</div>
                                               </dt>
                                               <dd class="layoutlr jiesuan_content">
                                                   <div class="right">
                                                       <ul class="showdata">
                                                           <li><span class="label left">PM2.5 : {$row2.start_pm25}-{$row2.end_pm25}</span><span class="right">开始时间：{$row2.start_time}</span></li>
                                                           <li><span class="label left">持续时间：{$row2.len_time}秒</span><span class="right">结束时间：{$row2.end_time}</span></li>
                                                       </ul>
                                                   </div>
                                               </dd>
                                           </dl>
                                       </a>
                                   </volist>
                               <else/>
                                   <dl class="no_data_div"><img src="__IMG__/no_data.png"><span>暂时没有数据</span></dl>
                               </notempty>
                           </div>
                           <div class="col-xs-12 loading">
                               <img src="__IMG__/loading.gif" alt="">
                           </div>
                       </div>
                    </div>
                </div>
            </div>



        </div>
    </div>
    <!-- 主体内容 结束 -->
    <!--装页码的div-->
    <div style="display:none" key="1" class="key"></div>
    <div style="display:none" key="1" class="list-page"></div>
</block>
<block name="js">
    <script type="text/javascript" src="__PUBLIC__/Echarts/echarts.common.min.js"></script>
    <script src="__PUBLIC__/dateItor/js/jquery.min.js"></script>
    <script src="__PUBLIC__/dateItor/js/mobiscroll_date.js" charset="gb2312"></script>
    <script src="__PUBLIC__/dateItor/js/mobiscroll.js"></script>
    <script type="text/javascript" src="__JS__/LCalendar.js"></script>
    <script type="text/javascript" src="__PUBLIC__/Layer3.1/layer.js"></script>
    <script src='https://cdn.bootcss.com/socket.io/2.0.3/socket.io.js'></script>
    <script type="text/javascript">
    /*$(document).ready(function(){
        console.log($('input[name="flag"]').val());
    })*/
    var role_id = '{$userinfo.role_id}';
    if(role_id>= 10 && role_id <= 13){
        // 如果服务端不在本机，请把127.0.0.1改成服务端ip
        var socket = io("http://{$server_ip}:2129");
        //    var socket = io("http://127.0.0.1:2129");
        var uid = "{$userinfo.id}";
        if(uid){
            // 当连接服务端成功时触发connect默认事件
            socket.on('connect', function(){
                socket.emit('login', uid);
            });
        }
        // 后端推送来消息时
        socket.on('new_msg', function(msg){
            if(msg == 'Alarm/index'){
                play_audio();
                setTimeout(function(){window.location.href=window.location.href+"?hhhhhh="+Math.random();},1200);
            }
        });
    }

    /* 告警声音 start */
    //加载告警音乐
    var audio;
    alarm_audio();
    function alarm_audio(){
      var borswer = window.navigator.userAgent.toLowerCase();
      if ( borswer.indexOf( "ie" ) >= 0 ){
        //IE内核浏览器
        var strEmbed = '<embed name="embedPlay" src="__PUBLIC__/audio/alarm.mp3" autostart="false" hidden="true" loop="false"></embed>';
        if ( $( "body" ).find( "embed" ).length <= 0 )
          $( "body" ).append( strEmbed );
        audio = document.embedPlay;

        //浏览器不支持 audion，则使用 embed 播放
        audio.volume = 100;
        //audio.play();//这个不需要
      } else
      {
        //非IE内核浏览器
        var strAudio = "<audio id='audioPlay' src='__PUBLIC__/audio/alarm.mp3' hidden='true'>";
        if ( $( "body" ).find( "audio" ).length <= 0 )
          $( "body" ).append( strAudio );
        audio = document.getElementById( "audioPlay" );
        //浏览器支持 audion
        //audio.play();
      }
    }

    //播放告警音乐
    //播放音乐
    function play_audio(){
      audio.play();
    }



        /*setTimeout(function(){window.location.href=window.location.href;},20000);*/
        /***房间数量超出一排显示下拉开关***/
        function but_show(){
            var kg_btn = $("#kq_height");
            var btn_icon =$(".btn_kq_icon");
            var btn_length = kg_btn.children(".btn").length;
            var btn_num =parseInt(kg_btn.width() / 54);
            if(btn_length > btn_num){
                btn_icon.addClass("btn_block");
                btn_icon.removeClass(" btn_none");
            }else {
                btn_icon.addClass("btn_none");
                btn_icon.removeClass("btn_block");
            }
        }
        but_show();
        $(document).ready(function(){

            /********房间下拉图标和向上关闭图标切换********/
            $(function(){
                var on_num = 0;
                $(".btn_kq_icon").click(function(){
                    var this_icon =  $(".btn_kq_icon");
                    if(on_num == 0){
                        this_icon.removeClass("btn_icon_bottom");
                        $("#kq_height").removeClass("pc_kq_height");
                        this_icon.addClass("btn_icon_top");
                        on_num = 1;
                    }else if(on_num == 1){
                        $("#kq_height").addClass("pc_kq_height");
                        this_icon.addClass("btn_icon_bottom");
                        this_icon.removeClass("btn_icon_top");
                        on_num = 0;
                    }
                })
            });
        });
        $("body").on('click','.room',function () {
            $(".room").removeClass("pitch_on");
            $(this).addClass("pitch_on");
            var value = $(this).attr('value');
            but_show();
        });
        $(document).on('click','.click_gj_list',function () {
            $(".click_gj_list").removeClass("gj_title_border");
            $(this).addClass("gj_title_border");
            // console.log($(this).text());
            if($(this).attr("istext") == "1"){  //当前告警
                $(".ls_gj_cont").hide();
                $(".gj_list_cont").show();
            }else{
                $(".gj_list_cont").hide();
                $(".ls_gj_cont").show();
            }
        });

        $(function(){
            $("#hotelsss").on('change',function(){
                var h_id=$(this).val();
                self.location.href = "{:U('Alarm/index')}?h_id="+h_id;
            });
        });


        //下拉显示更多
        //当前的数据一定要超过页面显示的
        $(window).scroll(function () {
            if($(".gj_title_border").attr("istext") == "2"){ //历史告警
                //alert(22222);
                var docHei = $(document).height(), winHei = $(window).height(), scrHei = $(document).scrollTop();
                if (scrHei >= docHei - winHei) {
                    $(".loading").show();
                    var key = $('.key').attr('key');//当前页码
                    key = key * 1 + 1;
                    //获取加载数据
                    $.ajax({
                        type:"POST",
                        url:"{:U('show_more_data')}?page="+$(".list-page").attr('key'),
                        data:{key:key},
                        success:function(info){
                            console.debug(info);
                            var info = eval("("+info+")");
                            if (info.status) {
                                var re_data = info.data;
                                $('.key').attr('key', re_data.key);          //添加最新显示页码
                                $(".list-page").attr('key',re_data.page);   //添加最新查询页码

                                //显示加载的数据
                                showHtml(re_data.datas);

                                //>>隐藏加载图
                                setTimeout(function () {
                                    $(".loading").hide();
                                }, 1000);
                            } else {
                                $(".loading").empty();
                                $(".loading").text("已全部加载完");
                            }
                        }
                    });
                }

            }

        });




        //显示加载的数据
        function showHtml(datas){
            $(datas).each(function () {
                var html = '';
                if($(this).attr("type") == 1){
                    html+='<a href="javascript:void(0)">\
                               <dl class="jiesuan_item">\
                                   <dt class="layoutlr jiesuan_title lay_1">\
                                       <div class="left">告警房间：'+$(this).attr("room_sno")+'</div>\
                                       <div class="right layoutlr_right">告警等级：'+$(this).attr("name")+'</div>\
                                   </dt>\
                                   <dd class="layoutlr jiesuan_content">\
                                        <div class="right">\
                                            <ul class="showdata">\
                                                <li><span class="label left">PM2.5 : '+$(this).attr("start_pm25")+'-'+$(this).attr("end_pm25")+'</span><span class="right">开始时间：'+$(this).attr("start_time")+'</span></li>\
                                                <li><span class="label left">持续时间：'+$(this).attr("len_time")+'秒</span><span class="right">结束时间：'+$(this).attr("end_time")+'</span></li>\
                                            </ul>\
                                        </div>\
                                    </dd>\
                               </dl>\
                           </a>';
                }else if($(this).attr("type") == 2){
                    html+='<a href="javascript:void(0)">\
                               <dl class="jiesuan_item">\
                                   <dt class="layoutlr jiesuan_title lay_2">\
                                       <div class="left">告警房间：'+$(this).attr("room_sno")+'</div>\
                                       <div class="right layoutlr_right">告警等级：'+$(this).attr("name")+'</div>\
                                   </dt>\
                                   <dd class="layoutlr jiesuan_content">\
                                        <div class="right">\
                                            <ul class="showdata">\
                                                <li><span class="label left">PM2.5 : '+$(this).attr("start_pm25")+'-'+$(this).attr("end_pm25")+'</span><span class="right">开始时间：'+$(this).attr("start_time")+'</span></li>\
                                                <li><span class="label left">持续时间：'+$(this).attr("len_time")+'秒</span><span class="right">结束时间：'+$(this).attr("end_time")+'</span></li>\
                                            </ul>\
                                        </div>\
                                    </dd>\
                               </dl>\
                           </a>';
                }else if($(this).attr("type") == 3){
                html+='<a href="javascript:void(0)">\
                               <dl class="jiesuan_item">\
                                   <dt class="layoutlr jiesuan_title lay_3">\
                                       <div class="left">告警房间：'+$(this).attr("room_sno")+'</div>\
                                       <div class="right layoutlr_right">告警等级：'+$(this).attr("name")+'</div>\
                                   </dt>\
                                   <dd class="layoutlr jiesuan_content">\
                                        <div class="right">\
                                            <ul class="showdata">\
                                                <li><span class="label left">PM2.5 : '+$(this).attr("start_pm25")+'-'+$(this).attr("end_pm25")+'</span><span class="right">开始时间：'+$(this).attr("start_time")+'</span></li>\
                                                <li><span class="label left">持续时间：'+$(this).attr("len_time")+'秒</span><span class="right">结束时间：'+$(this).attr("end_time")+'</span></li>\
                                            </ul>\
                                        </div>\
                                    </dd>\
                               </dl>\
                           </a>';
                }

                $(".history").append(html);
            });
        }

    </script>
</block>
